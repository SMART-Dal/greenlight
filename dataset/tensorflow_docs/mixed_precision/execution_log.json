2023-12-09 03:19:13.944793: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
Compute dtype: float16
Variable dtype: float32
The model will run with 4096 units on a GPU
<Policy "mixed_float16">
x.dtype: float16
dense1.kernel.dtype: float32
Outputs dtype: float16
Outputs dtype: float32
[EXECUTION] [03:19:14] Waiting before running function for 10 seconds.
[EXECUTION] [03:19:24] Sensors started
[STABLE CHECK] [03:19:27] Temperature too high: mean is 42, which is greater than 40
[STABLE CHECK] [03:19:27] Temperature is too high.
[STABLE CHECK] [03:19:27] Waiting 20 seconds to reach low temperature.

[STABLE CHECK] [03:19:47] Success: temperature is below threshold.
[MAIN] [03:19:47] Terminated sensors
[STABLE CHECK] [03:19:47] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [03:20:07] Success: Machine is stable.
[EXECUTION] [03:20:07] Successfully reached stable state
Epoch 1/5

1/6 [====>.........................] - ETA: 7s - loss: 2.3205 - accuracy: 0.1089
3/6 [==============>...............] - ETA: 0s - loss: 5.9670 - accuracy: 0.2950
5/6 [========================>.....] - ETA: 0s - loss: 5.4970 - accuracy: 0.3221
6/6 [==============================] - 2s 96ms/step - loss: 4.8665 - accuracy: 0.3727 - val_loss: 0.8693 - val_accuracy: 0.7412
Epoch 2/5

1/6 [====>.........................] - ETA: 0s - loss: 0.9051 - accuracy: 0.7253
3/6 [==============>...............] - ETA: 0s - loss: 0.8413 - accuracy: 0.7233
5/6 [========================>.....] - ETA: 0s - loss: 0.7203 - accuracy: 0.7725
6/6 [==============================] - 0s 56ms/step - loss: 0.6915 - accuracy: 0.7836 - val_loss: 0.5243 - val_accuracy: 0.8215
Epoch 3/5

1/6 [====>.........................] - ETA: 0s - loss: 0.5410 - accuracy: 0.8167
3/6 [==============>...............] - ETA: 0s - loss: 0.5147 - accuracy: 0.8225
5/6 [========================>.....] - ETA: 0s - loss: 0.4356 - accuracy: 0.8546
6/6 [==============================] - 0s 56ms/step - loss: 0.4075 - accuracy: 0.8660 - val_loss: 0.2364 - val_accuracy: 0.9311
Epoch 4/5

1/6 [====>.........................] - ETA: 0s - loss: 0.2571 - accuracy: 0.9249
3/6 [==============>...............] - ETA: 0s - loss: 0.3032 - accuracy: 0.9043
5/6 [========================>.....] - ETA: 0s - loss: 0.3474 - accuracy: 0.8940
6/6 [==============================] - 0s 56ms/step - loss: 0.3379 - accuracy: 0.8971 - val_loss: 0.2586 - val_accuracy: 0.9188
Epoch 5/5

1/6 [====>.........................] - ETA: 0s - loss: 0.2647 - accuracy: 0.9191
3/6 [==============>...............] - ETA: 0s - loss: 0.2257 - accuracy: 0.9326
5/6 [========================>.....] - ETA: 0s - loss: 0.2216 - accuracy: 0.9333
6/6 [==============================] - 0s 56ms/step - loss: 0.2312 - accuracy: 0.9298 - val_loss: 0.3869 - val_accuracy: 0.8778
[EXECUTION] [03:20:10] waiting idle for 30 seconds after function execution
[EXECUTION] [03:20:40] Performed tensorflow.keras.Model.fit() on input and will now save energy data.
inside_arg_size
++++++4++++++
++++++5++++++
5-size 188160144.0
++++++5++++++
5-size 60128.0
4-size 188220272.0
++++++5++++++
5-size 188160144.0
++++++5++++++
5-size 60128.0
outside_arg_size
inside_kwarg_size
++++++4++++++
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
++++++5++++++
5-size 72.0
4-size 192.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
++++++5++++++
5-size 72.0
outside_kwarg_size
inside_object_size
++++++5++++++
++++++6++++++ this __dict__ descriptor does not support '_DictWrapper' objects
6-size 48.0
outside_object_size
[EXECUTION] [03:20:41] Result: {'tensorflow.keras.Model.fit()': {'energy_data': {'cpu': '{"columns":["time_elapsed","energy (J)"],"
[EXECUTION] [03:20:41] Data written to file /home/saurabh/method-energy-dataset/dataset/tensorflow_docs/mixed_precision/experiment-5.json
[EXECUTION] [03:20:41] Waiting before running function for 10 seconds.
[EXECUTION] [03:20:51] Sensors started
[STABLE CHECK] [03:20:54] Success: temperature is below threshold.
[MAIN] [03:20:54] Terminated sensors
[STABLE CHECK] [03:20:54] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [03:21:14] Success: Machine is stable.
[EXECUTION] [03:21:14] Successfully reached stable state
313/313 - 1s - loss: 0.3953 - accuracy: 0.8733 - 1s/epoch - 4ms/step
[EXECUTION] [03:21:15] waiting idle for 30 seconds after function execution
[EXECUTION] [03:21:45] Performed tensorflow.keras.Model.evaluate() on input and will now save energy data.
inside_arg_size
++++++4++++++
++++++5++++++
5-size 31360144.0
++++++5++++++
5-size 10128.0
4-size 31370272.0
++++++5++++++
5-size 31360144.0
++++++5++++++
5-size 10128.0
outside_arg_size
inside_kwarg_size
++++++4++++++
++++++5++++++
5-size 56.0
4-size 56.0
++++++5++++++
5-size 56.0
outside_kwarg_size
inside_object_size
++++++5++++++
++++++6++++++ this __dict__ descriptor does not support '_DictWrapper' objects
6-size 48.0
outside_object_size
[EXECUTION] [03:21:45] Result: {'tensorflow.keras.Model.evaluate()': {'energy_data': {'cpu': '{"columns":["time_elapsed","energy (J
[EXECUTION] [03:21:45] Data written to file /home/saurabh/method-energy-dataset/dataset/tensorflow_docs/mixed_precision/experiment-5.json
Test loss: 0.39530012011528015
Test accuracy: 0.8733000159263611
Epoch 0: loss=5.731341361999512, test accuracy=0.769599974155426
Epoch 1: loss=0.5358676314353943, test accuracy=0.8932999968528748
Epoch 2: loss=0.3963865041732788, test accuracy=0.9398000240325928
Epoch 3: loss=0.2898368239402771, test accuracy=0.949999988079071
Epoch 4: loss=0.2962009608745575, test accuracy=0.8978000283241272
