2023-12-08 18:56:00.093188: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
WARNING:tensorflow:From /home/saurabh/method-energy-dataset/projects/tensorflow_docs_patched/site/en/guide/migrate/fault_tolerance_method-level.py:38: The name tf.estimator.inputs is deprecated. Please use tf.compat.v1.estimator.inputs instead.

WARNING:tensorflow:From /home/saurabh/method-energy-dataset/projects/tensorflow_docs_patched/site/en/guide/migrate/fault_tolerance_method-level.py:38: The name tf.estimator.inputs.numpy_input_fn is deprecated. Please use tf.compat.v1.estimator.inputs.numpy_input_fn instead.

WARNING:tensorflow:From /home/saurabh/miniconda3/envs/tf2/lib/python3.9/site-packages/tensorflow/python/training/training_util.py:400: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
WARNING:tensorflow:From /home/saurabh/miniconda3/envs/tf2/lib/python3.9/site-packages/tensorflow_estimator/python/estimator/inputs/queues/feeding_queue_runner.py:60: QueueRunner.__init__ (from tensorflow.python.training.queue_runner_impl) is deprecated and will be removed in a future version.
Instructions for updating:
To construct input pipelines, use the `tf.data` module.
WARNING:tensorflow:From /home/saurabh/miniconda3/envs/tf2/lib/python3.9/site-packages/tensorflow_estimator/python/estimator/inputs/queues/feeding_functions.py:491: add_queue_runner (from tensorflow.python.training.queue_runner_impl) is deprecated and will be removed in a future version.
Instructions for updating:
To construct input pipelines, use the `tf.data` module.
WARNING:tensorflow:From /home/saurabh/miniconda3/envs/tf2/lib/python3.9/site-packages/tensorflow/python/training/monitored_session.py:918: start_queue_runners (from tensorflow.python.training.queue_runner_impl) is deprecated and will be removed in a future version.
Instructions for updating:
To construct input pipelines, use the `tf.data` module.
WARNING:tensorflow:From /home/saurabh/miniconda3/envs/tf2/lib/python3.9/site-packages/tensorflow/python/training/saver.py:1056: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
WARNING:tensorflow:From /home/saurabh/miniconda3/envs/tf2/lib/python3.9/site-packages/tensorflow/python/training/saver.py:1165: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
[EXECUTION] [18:54:03] Waiting before running function for 10 seconds.
[EXECUTION] [18:54:13] Sensors started
[STABLE CHECK] [18:54:16] Success: temperature is below threshold.
[MAIN] [18:54:16] Terminated sensors
[STABLE CHECK] [18:54:16] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [18:54:36] Success: Machine is stable.
[EXECUTION] [18:54:36] Successfully reached stable state
[EXECUTION] [18:54:36] waiting idle for 30 seconds after function execution
[EXECUTION] [18:55:06] Performed tensorflow.compat.v1.estimator.RunConfig() on input and will now save energy data.
[EXECUTION] [18:55:06] skipping call added, current list is: ['tensorflow.compat.v1.estimator.RunConfig()']
inside_arg_size
outside_arg_size
inside_kwarg_size
++++++4++++++
++++++5++++++
5-size 72.0
++++++5++++++
5-size 72.0
4-size 144.0
++++++5++++++
5-size 72.0
++++++5++++++
5-size 72.0
outside_kwarg_size
inside_object_size
outside_object_size
[EXECUTION] [18:55:06] Result: {'tensorflow.compat.v1.estimator.RunConfig()': {'energy_data': {'cpu': '{"columns":["time_elapsed","
[EXECUTION] [18:55:06] Data written to file /home/saurabh/method-energy-dataset/dataset/tensorflow_docs/fault_tolerance/experiment-1.json
[EXECUTION] [18:55:06] Waiting before running function for 10 seconds.
[EXECUTION] [18:55:16] Sensors started
[STABLE CHECK] [18:55:19] Success: temperature is below threshold.
[MAIN] [18:55:19] Terminated sensors
[STABLE CHECK] [18:55:19] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [18:55:39] Not stable: stdev/mean is 0.030217770221953096, which is greater than 0.03
[STABLE CHECK] [18:55:39] Machine is not stable yet.
[STABLE CHECK] [18:55:39] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [18:55:59] Success: Machine is stable.
[EXECUTION] [18:55:59] Successfully reached stable state
[EXECUTION] [18:56:00] waiting idle for 30 seconds after function execution
[EXECUTION] [18:56:30] Performed tensorflow.compat.v1.estimator.DNNClassifier() on input and will now save energy data.
inside_arg_size
outside_arg_size
inside_kwarg_size
++++++4++++++
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
4-size 432.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
outside_kwarg_size
inside_object_size
outside_object_size
[EXECUTION] [18:56:30] Result: {'tensorflow.compat.v1.estimator.DNNClassifier()': {'energy_data': {'cpu': '{"columns":["time_elapse
[EXECUTION] [18:56:30] Data written to file /home/saurabh/method-energy-dataset/dataset/tensorflow_docs/fault_tolerance/experiment-1.json
[EXECUTION] [18:56:30] Waiting before running function for 10 seconds.
[EXECUTION] [18:56:40] Sensors started
[STABLE CHECK] [18:56:43] Success: temperature is below threshold.
[MAIN] [18:56:43] Terminated sensors
[STABLE CHECK] [18:56:43] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [18:57:03] Success: Machine is stable.
[EXECUTION] [18:57:03] Successfully reached stable state
[EXECUTION] [18:57:03] waiting idle for 30 seconds after function execution
[EXECUTION] [18:57:33] Performed tensorflow.compat.v1.estimator.inputs.numpy_input_fn() on input and will now save energy data.
[EXECUTION] [18:57:33] skipping call added, current list is: ['tensorflow.compat.v1.estimator.RunConfig()', 'tensorflow.compat.v1.estimator.inputs.numpy_input_fn()']
inside_arg_size
outside_arg_size
inside_kwarg_size
++++++4++++++
++++++5++++++
5-size 56.0
++++++5++++++
5-size 56.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
4-size 296.0
++++++5++++++
5-size 56.0
++++++5++++++
5-size 56.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
outside_kwarg_size
inside_object_size
outside_object_size
[EXECUTION] [18:57:33] Result: {'tensorflow.compat.v1.estimator.inputs.numpy_input_fn()': {'energy_data': {'cpu': '{"columns":["tim
[EXECUTION] [18:57:33] Data written to file /home/saurabh/method-energy-dataset/dataset/tensorflow_docs/fault_tolerance/experiment-1.json
[EXECUTION] [18:57:33] Waiting before running function for 10 seconds.
[EXECUTION] [18:57:43] Sensors started
[STABLE CHECK] [18:57:46] Success: temperature is below threshold.
[MAIN] [18:57:46] Terminated sensors
[STABLE CHECK] [18:57:46] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [18:58:06] Success: Machine is stable.
[EXECUTION] [18:58:06] Successfully reached stable state
RuntimeError:Interruption
[EXECUTION] [18:58:08] Waiting before running function for 10 seconds.
[EXECUTION] [18:58:18] Sensors started
[STABLE CHECK] [18:58:21] Success: temperature is below threshold.
[MAIN] [18:58:21] Terminated sensors
[STABLE CHECK] [18:58:21] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [18:58:41] Success: Machine is stable.
[EXECUTION] [18:58:41] Successfully reached stable state
[EXECUTION] [18:58:41] waiting idle for 30 seconds after function execution
[EXECUTION] [18:59:11] Performed tensorflow.compat.v1.estimator.DNNClassifier() on input and will now save energy data.
[EXECUTION] [18:59:12] skipping call added, current list is: ['tensorflow.compat.v1.estimator.RunConfig()', 'tensorflow.compat.v1.estimator.inputs.numpy_input_fn()', 'tensorflow.compat.v1.estimator.DNNClassifier()']
inside_arg_size
outside_arg_size
inside_kwarg_size
++++++4++++++
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
4-size 432.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 56.0
outside_kwarg_size
inside_object_size
outside_object_size
[EXECUTION] [18:59:12] Result: {'tensorflow.compat.v1.estimator.DNNClassifier()': {'energy_data': {'cpu': '{"columns":["time_elapse
[EXECUTION] [18:59:12] Data written to file /home/saurabh/method-energy-dataset/dataset/tensorflow_docs/fault_tolerance/experiment-1.json
[EXECUTION] [18:59:12] Waiting before running function for 10 seconds.
[EXECUTION] [18:59:22] Sensors started
[STABLE CHECK] [18:59:25] Success: temperature is below threshold.
[MAIN] [18:59:25] Terminated sensors
[STABLE CHECK] [18:59:25] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [18:59:45] Success: Machine is stable.
[EXECUTION] [18:59:45] Successfully reached stable state
[EXECUTION] [18:59:46] waiting idle for 30 seconds after function execution
[EXECUTION] [19:00:16] Performed tensorflow.compat.v1.estimator.DNNClassifier.train() on input and will now save energy data.
inside_arg_size
outside_arg_size
inside_kwarg_size
++++++4++++++
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
4-size 128.0
++++++5++++++
5-size 64.0
++++++5++++++
5-size 64.0
outside_kwarg_size
inside_object_size
++++++5++++++
5-size 3880.0
outside_object_size
[EXECUTION] [19:00:16] Result: {'tensorflow.compat.v1.estimator.DNNClassifier.train()': {'energy_data': {'cpu': '{"columns":["time_
[EXECUTION] [19:00:16] Data written to file /home/saurabh/method-energy-dataset/dataset/tensorflow_docs/fault_tolerance/experiment-1.json
[EXECUTION] [19:00:16] Waiting before running function for 10 seconds.
[EXECUTION] [19:00:26] Sensors started
[STABLE CHECK] [19:00:29] Success: temperature is below threshold.
[MAIN] [19:00:29] Terminated sensors
[STABLE CHECK] [19:00:29] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [19:00:49] Success: Machine is stable.
[EXECUTION] [19:00:49] Successfully reached stable state
[EXECUTION] [19:00:49] waiting idle for 30 seconds after function execution
[EXECUTION] [19:01:19] Performed tensorflow.keras.losses.SparseCategoricalCrossentropy() on input and will now save energy data.
[EXECUTION] [19:01:19] skipping call added, current list is: ['tensorflow.compat.v1.estimator.RunConfig()', 'tensorflow.compat.v1.estimator.inputs.numpy_input_fn()', 'tensorflow.compat.v1.estimator.DNNClassifier()', 'tensorflow.keras.losses.SparseCategoricalCrossentropy()']
inside_arg_size
outside_arg_size
inside_kwarg_size
++++++4++++++
++++++5++++++
5-size 64.0
4-size 64.0
++++++5++++++
5-size 64.0
outside_kwarg_size
inside_object_size
outside_object_size
[EXECUTION] [19:01:19] Result: {'tensorflow.keras.losses.SparseCategoricalCrossentropy()': {'energy_data': {'cpu': '{"columns":["ti
[EXECUTION] [19:01:19] Data written to file /home/saurabh/method-energy-dataset/dataset/tensorflow_docs/fault_tolerance/experiment-1.json
[EXECUTION] [19:01:19] Waiting before running function for 10 seconds.
[EXECUTION] [19:01:29] Sensors started
[STABLE CHECK] [19:01:32] Temperature too high: mean is 40.35, which is greater than 40
[STABLE CHECK] [19:01:32] Temperature is too high.
[STABLE CHECK] [19:01:32] Waiting 20 seconds to reach low temperature.

[STABLE CHECK] [19:01:52] Success: temperature is below threshold.
[MAIN] [19:01:52] Terminated sensors
[STABLE CHECK] [19:01:52] Waiting 20 seconds to reach stable state.

[STABLE CHECK] [19:02:12] Success: Machine is stable.
[EXECUTION] [19:02:12] Successfully reached stable state
Traceback (most recent call last):
  File "/home/saurabh/method-energy-dataset/projects/tensorflow_docs_patched/site/en/guide/migrate/fault_tolerance_method-level.py", line 71, in <module>
    backup_restore_callback = tf.keras.callbacks.BackupAndRestore(backup_dir=log_dir)
AttributeError: module 'keras.api._v2.keras.callbacks' has no attribute 'BackupAndRestore'
